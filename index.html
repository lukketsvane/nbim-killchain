<!DOCTYPE html>
<html lang="no">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NBIM KILLCHAIN // Dashboard</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://unpkg.com/lucide@latest"></script>
</head>
<body>
    <div class="container">
        <header>
            <div>
                <h1><i data-lucide="shield-alert" class="text-red"></i> NBIM <span class="text-zinc-400">KILLCHAIN</span></h1>
                <div class="subtitle">:: Fra norske sparepenger til militær operasjon ::</div>
            </div>
            <div id="nav-container"></div>
        </header>

        <main class="grid">
            
            <!-- TOTAL EXPOSURE -->
            <div class="col-span-2 row-span-2 card">
                <div class="corner tl"></div><div class="corner tr"></div><div class="corner bl"></div><div class="corner br"></div>
                <div class="card-header">
                    <span class="card-title"><i data-lucide="terminal" size="16"></i> TOTAL EKSPONERING</span>
                </div>
                <div class="stats-grid">
                    <div class="stat-box">
                        <span class="stat-label">TOTAL VERDI (USD)</span>
                        <span class="stat-val" id="total-usd">...</span>
                        <span class="stat-sub" id="total-nok">...</span>
                    </div>
                    <div class="stat-box">
                        <span class="stat-label">SNITT EIGERSKAP</span>
                        <span class="stat-val" id="avg-stake">...</span>
                        <span class="stat-sub">I KILL CHAIN SELSKAP</span>
                    </div>
                    <div class="stat-box">
                        <span class="stat-label">IDENTIFISERTE SELSKAP</span>
                        <span class="stat-val text-red" id="company-count">...</span>
                        <span class="stat-sub"> DIREKTE KNYTTET</span>
                    </div>
                    <div class="stat-box">
                        <span class="stat-label">STØRSTE POST</span>
                        <span class="stat-val" id="top-stake-val">...</span>
                        <span class="stat-sub" id="top-stake-name">...</span>
                    </div>
                </div>
            </div>

            <!-- KILL CHAIN SUMMARY LINK -->
            <div class="col-span-2 lg:col-span-6 row-span-2 card">
                <div class="corner tl"></div><div class="corner tr"></div><div class="corner bl"></div><div class="corner br"></div>
                <div class="card-header">
                    <span class="card-title"><i data-lucide="activity" size="16"></i> SYSTEMATISK OVERSIKT</span>
                    <span class="subtitle">F2T2EA SYKLUS</span>
                </div>
                
                <!-- Simple CSS Bar Chart based on data -->
                <div id="chain-bars" style="display: flex; flex-direction: column; gap: 0.75rem; justify-content: center; height: 100%;">
                    <!-- Javascript will populate this -->
                </div>
            </div>

            <!-- TECH GIANT CALLOUT -->
            <div class="col-span-2 lg:col-span-4 row-span-2 card dark">
                <div class="corner tl"></div><div class="corner tr"></div>
                <div class="card-header">
                    <span class="card-title"><i data-lucide="cloud" size="16"></i> DIGITAL INFRASTRUKTUR</span>
                </div>
                <div style="display: flex; flex-direction: column; justify-content: center; height: 100%; gap: 1rem;">
                    <div style="font-size: 2.5rem; font-weight: 700;" id="tech-total">...</div>
                    <div style="color: var(--text-zinc-400); line-height: 1.5;">
                        Project Nimbus, Azure og AWS utgjør ryggraden i den moderne krigføringen. NBIM sine investeringer i Big Tech er no den største kilden til militær eksponering.
                    </div>
                </div>
            </div>

            <!-- RECENT UPDATES -->
            <div class="col-span-2 lg:col-span-4 row-span-2 card">
                <div class="corner bl"></div><div class="corner br"></div>
                <div class="card-header">
                    <span class="card-title"><i data-lucide="radio" size="16"></i> SISTE OPPDATERINGER</span>
                </div>
                <div class="kc-list">
                    <div class="kc-item" style="border:none; padding:0;">
                        <div style="font-weight:700; color:var(--accent-red);">NY: VALERO ENERGY</div>
                        <div style="font-size:0.7rem; color:var(--text-zinc-500);">NBIM øker post i leverandør av JP-8 flybensin.</div>
                    </div>
                    <div class="kc-item" style="border:none; padding:0; margin-top:0.5rem;">
                        <div style="font-weight:700; color:var(--accent-red);">NY: RHEINMETALL</div>
                        <div style="font-size:0.7rem; color:var(--text-zinc-500);">Massiv auke i 155mm produksjon koblet til NBIM.</div>
                    </div>
                    <div class="kc-item" style="border:none; padding:0; margin-top:0.5rem;">
                        <div style="font-weight:700; color:var(--text-zinc-900);">PROJECT NIMBUS</div>
                        <div style="font-size:0.7rem; color:var(--text-zinc-500);">Google/Amazon kontraktar bekrefta via lekkasjar.</div>
                    </div>
                </div>
            </div>

        </main>

        <footer>
            <div id="last-updated">DATA PR: ...</div>
            <div>KJELDER: <a href="https://www.nbim.no/" target="_blank">NBIM</a> | <a href="https://www.sec.gov/cgi-bin/browse-edgar?action=getcompany&company=norges+bank&type=13F" target="_blank">SEC 13F</a> | <a href="https://www.972mag.com/lavender-ai-israeli-army-gaza/" target="_blank">+972 Mag</a> | <a href="https://www.ohchr.org/sites/default/files/documents/hrbodies/hrcouncil/sessions-regular/session59/advance-version/a-hrc-59-23-aev.pdf" target="_blank">UN A/HRC/59/23</a></div>
        </footer>
    </div>

    <!-- SCRIPTS -->
    <script src="assets/js/data.js"></script>
    <script src="assets/js/main.js"></script>
    <script>
        // Inline Dashboard Logic for simplicity (or move to assets/js/dashboard.js)
        document.addEventListener('DOMContentLoaded', () => {
            Utils.renderNavigation('index');
            
            const stats = nbimData.getStats();
            
            // Populate Top Stats
            document.getElementById('total-usd').textContent = Utils.formatCurrency(stats.totalValueUsd);
            document.getElementById('total-nok').textContent = Utils.formatNOK(stats.totalValueUsd);
            document.getElementById('avg-stake').textContent = stats.avgStake + '%';
            document.getElementById('company-count').textContent = stats.companyCount;
            
            // Find largest stake
            const topCompany = nbimData.companies.reduce((prev, current) => (prev.nbim_pct > current.nbim_pct) ? prev : current);
            document.getElementById('top-stake-val').textContent = topCompany.nbim_pct + '%';
            document.getElementById('top-stake-name').textContent = topCompany.name;

            // Tech Total
            const techVal = nbimData.getStepTotal('find') + nbimData.getStepTotal('fix');
            document.getElementById('tech-total').textContent = Utils.formatCurrency(techVal);

            // Last Updated
            document.getElementById('last-updated').textContent = "SIST OPPDATERT: " + nbimData.meta.lastUpdated;

            // Generate Chain Bars
            const container = document.getElementById('chain-bars');
            Object.values(nbimData.killChainSteps).forEach(step => {
                const val = nbimData.getStepTotal(step.name.toLowerCase());
                // Calculate percentage width relative to total tech val (arbitrary max for visual scaling)
                const width = Math.min(100, (val / 50000) * 100); 
                
                const html = `
                    <div style="display:flex; align-items:center; font-size:0.7rem; gap:1rem;">
                        <div style="width:3rem; font-weight:700;">${step.name}</div>
                        <div style="flex:1; height:1.5rem; background:var(--bg-zinc-50); border:1px solid var(--border-zinc-200); position:relative;">
                            <div style="width:${width}%; background:var(--text-zinc-900); height:100%;"></div>
                            <div style="position:absolute; right:0.5rem; top:0.25rem; color:var(--text-zinc-500);">${Utils.formatCurrency(val)}</div>
                        </div>
                    </div>
                `;
                container.innerHTML += html;
            });
        });
    </script>
</body>
</html>
